import pandas as pd

# --- 1. ê°€ìƒì˜(Dummy) ê°ì—¼ë³‘ ë°ì´í„° ìƒì„± ---
# ì‹¤ì œ ë°ì´í„°ê°€ ì•„ë‹ˆë©°, ê¸°ëŠ¥ì„ ì‹œì—°í•˜ê¸° ìœ„í•œ ì˜ˆì‹œ ë°ì´í„°ì…ë‹ˆë‹¤.
# 2024ë…„ ê¸°ì¤€ ìµœì‹  ë°ì´í„°ë¥¼ ê°€ì •í•©ë‹ˆë‹¤. (ì‹¤ì œ ë°ì´í„°ëŠ” ì§ˆë³‘ê´€ë¦¬ì²­ ë“±ì—ì„œ í™•ì¸ í•„ìš”)

data = {
    'ì§€ì—­': ['ì„œìš¸íŠ¹ë³„ì‹œ', 'ë¶€ì‚°ê´‘ì—­ì‹œ', 'ëŒ€êµ¬ê´‘ì—­ì‹œ', 'ì¸ì²œê´‘ì—­ì‹œ', 'ê´‘ì£¼ê´‘ì—­ì‹œ',
             'ëŒ€ì „ê´‘ì—­ì‹œ', 'ìš¸ì‚°ê´‘ì—­ì‹œ', 'ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ', 'ê²½ê¸°ë„', 'ê°•ì›íŠ¹ë³„ìì¹˜ë„',
             'ì¶©ì²­ë¶ë„', 'ì¶©ì²­ë‚¨ë„', 'ì „ë¼ë¶ë„', 'ì „ë¼ë‚¨ë„', 'ê²½ìƒë¶ë„',
             'ê²½ìƒë‚¨ë„', 'ì œì£¼íŠ¹ë³„ìì¹˜ë„'],
    'ì¸êµ¬ìˆ˜_2024_ê°€ìƒ': [9400000, 3300000, 2400000, 3000000, 1400000,
                       1450000, 1100000, 390000, 13600000, 1500000,
                       1650000, 2150000, 1750000, 1800000, 2600000,
                       3300000, 680000],
    'ë…ê°_í™˜ììˆ˜_2024_ê°€ìƒ': [282000, 99000, 72000, 90000, 42000,
                             43500, 33000, 11700, 408000, 45000,
                             49500, 64500, 52500, 54000, 78000,
                             99000, 20400],
    'ê²°í•µ_í™˜ììˆ˜_2024_ê°€ìƒ': [9400, 3300, 2400, 3000, 1400,
                           1450, 1100, 390, 13600, 1500,
                           1650, 2150, 1750, 1800, 2600,
                           3300, 680],
    'ìˆ˜ì¡±êµ¬ë³‘_í™˜ììˆ˜_2024_ê°€ìƒ': [47000, 16500, 12000, 15000, 7000,
                                 7250, 5500, 1950, 68000, 7500,
                                 8250, 10750, 8750, 9000, 13000,
                                 16500, 3400],
    'ë…¸ë¡œë°”ì´ëŸ¬ìŠ¤_í™˜ììˆ˜_2024_ê°€ìƒ': [18800, 6600, 4800, 6000, 2800,
                                   2900, 2200, 780, 27200, 3000,
                                   3300, 4300, 3500, 3600, 5200,
                                   6600, 1360],
    'ì¼ë³¸ë‡Œì—¼_í™˜ììˆ˜_2024_ê°€ìƒ': [94, 165, 72, 90, 70, # ë‚¨ë¶€ ì§€ì—­ í™˜ììˆ˜ ìƒí–¥ ì¡°ì •
                              73, 55, 19, 136, 45,
                              49, 107, 87, 180, 130, # ë‚¨ë¶€ ì§€ì—­ í™˜ììˆ˜ ìƒí–¥ ì¡°ì •
                              165, 102], # ì œì£¼ ì§€ì—­ ìƒí–¥ ì¡°ì •
    'ë¹„ë¸Œë¦¬ì˜¤íŒ¨í˜ˆì¦_í™˜ììˆ˜_2024_ê°€ìƒ': [0, 66, 0, 90, 0, # í•´ì•ˆ ì§€ì—­ ìœ„ì£¼ ë°œìƒ
                                   0, 55, 0, 0, 0,
                                   0, 107, 175, 270, 130, # ì„œë‚¨í•´ì•ˆ ì§€ì—­ ìƒí–¥ ì¡°ì •
                                   165, 68] # ì œì£¼ ì§€ì—­ ìƒí–¥ ì¡°ì •
}

df = pd.DataFrame(data)

# ê° ì§ˆë³‘ì˜ í¼ì„¼íŠ¸ ê³„ì‚° í•¨ìˆ˜
def calculate_percentage(row, disease_col_prefix):
    # 'ë…ê°_í™˜ììˆ˜_2024_ê°€ìƒ' í˜•ì‹ì˜ ì»¬ëŸ¼ëª…ì—ì„œ 'ë…ê°' ë¶€ë¶„ë§Œ ì¶”ì¶œí•˜ì—¬ ì§ˆë³‘ëª…ìœ¼ë¡œ ì‚¬ìš©
    disease_name = disease_col_prefix.split('_')[0] 
    
    patient_col = f'{disease_name}_í™˜ììˆ˜_2024_ê°€ìƒ'
    
    total_patients = row[patient_col]
    population = row['ì¸êµ¬ìˆ˜_2024_ê°€ìƒ']
    return (total_patients / population) * 100 if population > 0 else 0.0

# ëª¨ë“  ê°ì—¼ë³‘ í¼ì„¼íŠ¸ ì¹¼ëŸ¼ ì¶”ê°€
disease_names = ['ë…ê°', 'ê²°í•µ', 'ìˆ˜ì¡±êµ¬ë³‘', 'ë…¸ë¡œë°”ì´ëŸ¬ìŠ¤', 'ì¼ë³¸ë‡Œì—¼', 'ë¹„ë¸Œë¦¬ì˜¤íŒ¨í˜ˆì¦']
for disease in disease_names:
    df[f'{disease}_í¼ì„¼íŠ¸'] = df.apply(lambda row: calculate_percentage(row, disease), axis=1)

# --- 2. ì•± ì‹¤í–‰ í•¨ìˆ˜ ---
def get_regional_disease_info():
    print("--- ëŒ€í•œë¯¼êµ­ ì§€ì—­ë³„ ì£¼ìš” ê°ì—¼ë³‘ í˜„í™© (2024ë…„ ê°€ìƒ ë°ì´í„° ê¸°ë°˜) ---")
    print("ì •ë³´ë¥¼ ì•Œê³  ì‹¶ì€ ì§€ì—­ì˜ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")

    # ì§€ì—­ ëª©ë¡ ì¶œë ¥
    for i, region_name in enumerate(df['ì§€ì—­']):
        print(f"{i+1}. {region_name}")
    print(f"{len(df)+1}. ì¢…ë£Œ") # ì¢…ë£Œ ì˜µì…˜ ì¶”ê°€

    while True:
        try:
            user_choice = input("\në²ˆí˜¸ ì…ë ¥: ").strip()

            if user_choice == str(len(df)+1):
                print("ì•±ì„ ì¢…ë£Œí•©ë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ˜ƒ")
                break

            choice_index = int(user_choice) - 1 # ì‚¬ìš©ìê°€ 1ë¶€í„° ì‹œì‘í•˜ëŠ” ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë¯€ë¡œ -1

            if 0 <= choice_index < len(df):
                selected_row = df.iloc[choice_index]
                region_name = selected_row['ì§€ì—­']
                population = selected_row['ì¸êµ¬ìˆ˜_2024_ê°€ìƒ']

                print(f"\n--- {region_name} ({population:,}ëª…)ì˜ ì£¼ìš” ê°ì—¼ë³‘ í˜„í™© ---")

                # ì£¼ìš” ê°ì—¼ë³‘ í¼ì„¼íŠ¸ë¥¼ ì¶”ì¶œí•˜ì—¬ ì •ë ¬
                diseases_info = {}
                for disease in disease_names:
                    percentage_col = f'{disease}_í¼ì„¼íŠ¸'
                    if percentage_col in selected_row: # í•´ë‹¹ ì§ˆë³‘ í¼ì„¼íŠ¸ ì»¬ëŸ¼ì´ ìˆëŠ”ì§€ í™•ì¸
                        diseases_info[disease] = selected_row[percentage_col]
                
                # í¼ì„¼íŠ¸ê°€ ë†’ì€ ìˆœì„œëŒ€ë¡œ ì •ë ¬í•˜ì—¬ ìƒìœ„ 3ê°œë§Œ ì„ íƒ
                sorted_diseases = sorted(diseases_info.items(), key=lambda item: item[1], reverse=True)[:3]

                if sorted_diseases:
                    for i, (disease, percentage) in enumerate(sorted_diseases):
                        # í•´ë‹¹ ì§ˆë³‘ì˜ í™˜ì ìˆ˜ë„ í•¨ê»˜ í‘œì‹œ
                        patient_count_col = f'{disease}_í™˜ììˆ˜_2024_ê°€ìƒ'
                        patient_count = selected_row[patient_count_col] if patient_count_col in selected_row else 'N/A'
                        print(f"{i+1}. {disease}: {percentage:.2f}% (í™˜ììˆ˜: {patient_count:,}ëª…)")
                else:
                    print("ì´ ì§€ì—­ì— ë³´ê³ ëœ ì£¼ìš” ê°ì—¼ë³‘ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. (ë°ì´í„° ë¶€ì¡±)")

            else:
                print("âš ï¸ ìœ íš¨í•˜ì§€ ì•Šì€ ë²ˆí˜¸ì…ë‹ˆë‹¤. ëª©ë¡ì— ìˆëŠ” ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")

        except ValueError:
            print("âš ï¸ ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
        except Exception as e:
            print(f"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {e}")

# --- ì•± ì‹¤í–‰ ---
if __name__ == "__main__":
    get_regional_disease_info()
